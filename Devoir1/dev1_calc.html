<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculatrice</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .calculator {
            background: #0d1a33;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            width: 320px;
            max-width: 100%;
        }

        .display {
            background: #0f2857;
            border: 3px solid #223a5e; 
            border-radius: 10px ;
            padding: 20px;
            margin-bottom: 20px;
            text-align: right;
            color: white;
            font-size: 2.5rem;
            font-weight: 300;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .button {
            border: none;
            border-radius: 15px;
            font-size: 1.5rem;
            font-weight: 600;
            height: 70px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: white;
            outline: none;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .button:active {
            transform: translateY(0);
        }

        .button.number {
            background:  #223a5e;
        }

        .button.number:hover {
            background: #124ba1;
        }

        .button.operator {
            background: #e74c3c;
        }

        .button.operator:hover {
            background: #c0392b;
        }

        .button.clear {
            background: #f39c12;
        }

        .button.clear:hover {
            background: #e67e22;
        }

        .button.equals {
            background: #27ae60;
        }

        .button.equals:hover {
            background: #229954;
        }

        .button.zero {
            grid-column: span 2;
        }

        .button.equals {
        background: #229954;
        grid-column: span 2;  
    }


        @media (max-width: 480px) {
            .calculator {
                width: 100%;
                padding: 15px;
            }
            
            .button {
                height: 60px;
                font-size: 1.3rem;
            }
            
            .display {
                font-size: 2rem;
                min-height: 70px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

  <script type="text/babel">
        const { useState } = React;

        function Calculator() {
            const [display, setDisplay] = useState('0');
            const [expression, setExpression] = useState('0'); 
            const [previousValue, setPreviousValue] = useState(null);
            const [operation, setOperation] = useState(null);
            const [waitingForOperand, setWaitingForOperand] = useState(false);

            const inputNumber = (num) => {
                if (display === 'Error') {
                    setDisplay(String(num));
                    setExpression(String(num));
                    setWaitingForOperand(false);
                    return;
                }

                if (waitingForOperand) {
                    setDisplay(String(num));
                    setExpression(prev => prev + num);
                    setWaitingForOperand(false);
                } else {
                    setDisplay(display === '0' ? String(num) : display + num);
                    setExpression(prev => (prev === '0' ? String(num) : prev + num));
                }
            };

            const inputOperation = (nextOperation) => {
                const inputValue = parseFloat(display);

                if (previousValue === null) {
                    setPreviousValue(inputValue);
                } else if (operation) {
                    const currentValue = previousValue || 0;
                    const newValue = calculate(currentValue, inputValue, operation);
                    setDisplay(String(newValue));
                    setPreviousValue(newValue);
                }

                setWaitingForOperand(true);
                setOperation(nextOperation);

                // Add operator to expression
                setExpression(prev => prev + nextOperation);
            };

            const calculate = (firstValue, secondValue, operation) => {
                switch (operation) {
                    case '+':
                        return firstValue + secondValue;
                    case '-':
                        return firstValue - secondValue;
                    case '×':
                        return firstValue * secondValue;
                    case '/':
                        if (secondValue === 0) {
                            return 'Error'; 
                        }
                        return firstValue / secondValue;
                    case '=':
                        return secondValue;
                    default:
                        return secondValue;
                }
            };

            const performCalculation = () => {
                const inputValue = parseFloat(display);

                if (previousValue !== null && operation) {
                    const newValue = calculate(previousValue, inputValue, operation);
                    setDisplay(String(newValue));
                    setExpression(String(newValue)); 
                    setPreviousValue(null);
                    setOperation(null);
                    setWaitingForOperand(true);
                }
            };

            const clearAll = () => {
                setDisplay('0');
                setExpression('0');
                setPreviousValue(null);
                setOperation(null);
                setWaitingForOperand(false);
            };

            const clearEntry = () => {
                setDisplay('0');
                setExpression('0');
            };

            const inputDecimal = () => {
                if (waitingForOperand || display === 'Error') {
                    setDisplay('0.');
                    setExpression(prev => prev === 'Error' ? '0.' : prev + '0.');
                    setWaitingForOperand(false);
                } else if (display.indexOf('.') === -1) {
                    setDisplay(display + '.');
                    setExpression(prev => prev + '.');
                }
            };

            const backspace = () => {
                if (display === 'Error') {
                    setDisplay('0');
                    setExpression('0');
                    return;
                }

                if (display.length > 1) {
                    setDisplay(display.slice(0, -1));
                    setExpression(prev => prev.slice(0, -1));
                } else {
                    setDisplay('0');
                    setExpression('0');
                }
            };

            return (
                <div className="calculator">
                    <div className="display">{expression}</div> {/* Show full expression */}
                    <div className="buttons">
                        <button className="button clear" onClick={clearAll}>AC</button>
                        <button className="button operator" onClick={() => inputOperation('/')}>/</button>
                        <button className="button operator" onClick={() => inputOperation('×')}>×</button>
                        <button className="button operator" onClick={backspace}>⌫</button>

                        <button className="button number" onClick={() => inputNumber(7)}>7</button>
                        <button className="button number" onClick={() => inputNumber(8)}>8</button>
                        <button className="button number" onClick={() => inputNumber(9)}>9</button>
                        <button className="button operator" onClick={() => inputOperation('-')}>-</button>

                        <button className="button number" onClick={() => inputNumber(4)}>4</button>
                        <button className="button number" onClick={() => inputNumber(5)}>5</button>
                        <button className="button number" onClick={() => inputNumber(6)}>6</button>
                        <button className="button operator" onClick={() => inputOperation('+')}>+</button>

                        <button className="button number" onClick={() => inputNumber(1)}>1</button>
                        <button className="button number" onClick={() => inputNumber(2)}>2</button>
                        <button className="button number" onClick={() => inputNumber(3)}>3</button>
                        <button className="button operator" onClick={inputDecimal}>.</button>

                        <button className="button number zero" onClick={() => inputNumber(0)}>0</button>
                        <button className="button equals" onClick={performCalculation}>=</button>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<Calculator />, document.getElementById('root'));
    </script>
</body>
</html>